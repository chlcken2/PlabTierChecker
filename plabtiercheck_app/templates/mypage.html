{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="container vh-100">
    <div class="row d-flex flex-nowrap vh-100 mt-4">
        <!-- 왼쪽 컬럼 -->
        <div class="col-4 d-flex mr-2 flex-column bg-white vh-100">
            <section>
                <div class="d-flex flex-column justify-content-between align-items-center mb-4">
                    <div class="d-flex justify-content-between align-items-center w-100">
                        <p class="h4 mb-0">{{user.username}}</p>
                        <div class="mt-2">
                            <button class="btn btn-primary btn-sm me-2">프로필 보기</button>
                            <button class="btn btn-secondary btn-sm" id="connectBluetooth">블루투스 연결하기</button>
                        </div>
                    </div>
                    <div class="d-flex justify-content-start align-items-center w-100">
                        <p class="mr-2">kakaoid</p>
                        <span class="custom-kakao">kakao</span>
                    </div>
                </div>
                <div class=" d-flex justify-content-between">
                    <a href="/mypage/mymanner" class="custom-item-double d-flex flex-column align-items-start p-3 pb-2">
                        <p class="mb-2">매너</p>
                        <div class="d-flex flex-row align-items-center">
                            <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_manner_card.svg" alt="" class="mr-2">
                            <p class="font-weight-bold"> 좋아요</p>
                        </div>
                    </a>
                    <a href="/mypage/mylevel" class="custom-item-double d-flex flex-column align-items-start p-3">
                        <p class="mb-2">레벨</p>
                        <div class="d-flex flex-row align-items-center">
                            <p class="badge badge-semipro badge_lv-system">P1</p>
                            <p class="font-weight-bold">세미프로1</p>
                            <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_level_auth.svg" style="width: 14px; height: 14px; margin-left: 5px;">
                        </div>
                    </a>
                </div>
            </section>
            <section>
                <div about="banner_middel">
                    <a href="#" class="banner-magazine_wrap">
                        <div class="banner-magazine_title">
                            <p>가이드</p>
                            <h3 class="font-weight-bold">플랩티어체크 사용법</h3>
                        </div>
                        <div class="banner-magazine_thumb"><img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_level_2.svg"></div>
                    </a>
                </div>
            </section>
        </div>
        <!-- 오른쪽 컬럼 -->
         <div class="col-8 d-flex mr-2 flex-column bg-light vh-100">
            <!-- 첫 번째 행 -->
            <div class="row mb-2 bg-white h-30">
                <div class="p-3 pb-4">
                    <!-- 여기에 첫 번째 행의 내용 -->
                    <p class="font-weight-bold pb-3">나의 플랩</p>
                    <ul>
                        <div class="py-2">
                            <a href="" class="d-flex flex-row align-items-center">
                                <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_myplab_color.svg" alt="신청 내역"width="24" height="24" class="mr-2">
                                <li>신청 내역</li>
                            </a>
                        </div>
                        <div class="py-2">
                            <a href="" class="d-flex flex-row align-items-center">
                                <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_profile.svg" alt="프로필수정" width="24" height="24" class="mr-2">
                                <li>프로필 수정</li>
                            </a>
                        </div>
                        <div class="py-2">
                            <a href="" class="d-flex flex-row align-items-center">
                                <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_setting_color.svg" alt="설정" width="24" hegith="24" class="mr-2">
                                <li>설정</li>
                            </a>
                        </div>
                    </ul>
                </div>
            </div>
             <div class="row mb-2 bg-white h-30">
                <div class="p-3 pb-4">
                    <!-- 여기에 두 번째 행의 내용 -->
                    <div class="d-flex align-items-center pb-3">
                        <p class="font-weight-bold ">팀</p>
                        <img class="mr-1" src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_level_auth.svg" style="width: 14px; height: 14px; margin-left: 5px;">
                        <p style="font-size:12px; text-decoration:underline;">팀을 생성해야 활동 가능합니다.</p>
                    </div>
                    <ul>
                        <div class="py-2 pb-4">
                            {% for team in user_teams %}
                            <a href="" class="d-flex flex-row align-items-center">
                                <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_friend.svg" alt="친구"width="24" height="24" class="mr-2">
                                <li>{ team.name }</li>
                            </a>
                            {% empty %}
                            <div>가입한 팀이 없습니다.</div>
                            {% endfor %}
                        </div>
                        <div class="py-2">
                            <a href="" class="d-flex flex-row align-items-center">
                                <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_email.svg" alt="스카웃"width="24" height="24" class="mr-2">
                                <li>팀 가입하기</li>
                            </a>
                        </div>
                        <div class="py-2 d-flex flex-row align-items-center">
                            <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_email.svg" alt="스카웃"width="24" height="24" class="mr-2">
                            <a class="d-flex flex-row align-items-center" data-bs-toggle="modal" href="#teamCreateModalToggle" role="button">팀 만들기</a>
                        </div>
                        {% include 'team_create_modal.html' %}
                    </ul>
                </div>
            </div>
            <!-- 두 번째 행 -->
            <div class="row mb-2 bg-white h-30">
                <div class="p-3 pb-4">
                    <!-- 여기에 두 번째 행의 내용 -->
                    <p class="font-weight-bold pb-3">고객센터</p>
                    <ul>
                        <div class="py-2">
                            <a href="" class="d-flex flex-row align-items-center">
                                <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_faq_color.svg" alt="자주 묻는 질문" width="24" hegith="24" class="mr-2">
                                <li>자주 묻는 질문</li>
                            </a>
                        </div>
                        <div class="py-2">
                            <a href="" class="d-flex flex-row align-items-center">
                                <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_notice_color.svg" alt="공지사항" width="24" hegith="24" class="mr-2">
                                <li>공지사항</li>
                            </a>
                        </div>
                    </ul>
                </div>
            </div>
            <!-- 세 번째 행 -->
            <div class="row bg-white h-100">
                <div class="p-3 pb-4">
                    <p class="font-weight-bold pb-3">더보기</p>
                    <ul>
                        <div class="py-2">
                            <a href="" class="d-flex flex-row align-items-center">
                                <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_about_color.svg" alt="플랩풋볼 소개" width="24" hegith="24" class="mr-2">
                                <li>플랩TierChecker소개</li>
                            </a>
                        </div>
                        <div class="py-2">
                            <a href="" class="d-flex flex-row align-items-center">
                                <img src="https://d31wz4d3hgve8q.cloudfront.net/static/img/ic_magazine_color.svg" alt="매거진" width="24" hegith="24" class="mr-2">
                                <li>제작자</li>
                            </a>
                        </div>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% if user.is_authenticated %}
<script>
  let userName = "{{ user.username }}";
  let id = "{{ user.id }}";
  
  document.getElementById('connectBluetooth').addEventListener('click', function() {
    if (!navigator.bluetooth) {
      alert("Web Bluetooth is not available in this browser.");
      console.error("Web Bluetooth is not available in this browser.");
      return;
    }

    alert(userName +"#"+id+ " 계정으로 연결합니다. (Web Bluetooth is available in this browser.)");

    navigator.bluetooth.requestDevice({
      acceptAllDevices: true
    // filters: [{ name: 'WH-1000XM5' }] 장치명 나면 장치 등록  네임 + 숫자
    })
    .then(device => {
      alert('장치 선택됨: ' + device.name);
      console.log('장치 선택됨:', device.name);
      return device.gatt.connect();
    })
    .then(server => {
      alert('블루투스 장치에 연결되었습니다: ' + server);
      console.log('블루투스 장치에 연결되었습니다:', server);
      // 여기서 추가적인 서비스 및 특성 작업 수행
    })
    .catch(error => {
      alert('블루투스 연결 중 오류 발생: ' + error);
      console.error('블루투스 연결 중 오류 발생:', error);
    });
  });
</script>
{% endif %}
{% endblock %}